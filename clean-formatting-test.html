<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üìù NULL VOID AI - Clean Formatting Test</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        min-height: 100vh;
      }
      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .header {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }
      .header h1 {
        margin: 0;
        font-size: 2.2em;
      }
      .content {
        padding: 30px;
      }
      .test-section {
        margin: 25px 0;
        padding: 20px;
        border-radius: 10px;
        border-left: 5px solid #28a745;
        background: #f8f9fa;
      }
      .warning {
        background: #fff3cd;
        border-left-color: #ffc107;
        color: #856404;
      }
      .bad-example {
        background: #f8d7da;
        border-left-color: #dc3545;
        color: #721c24;
      }
      .good-example {
        background: #d4edda;
        border-left-color: #28a745;
        color: #155724;
      }
      button {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        cursor: pointer;
        margin: 8px;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
      }
      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
      }
      .chat-container {
        margin-top: 25px;
        padding: 20px;
        border: 2px solid #28a745;
        border-radius: 15px;
        background: linear-gradient(145deg, #f8f9fa, #e9ecef);
      }
      #chatMessages {
        height: 500px;
        overflow-y: auto;
        border: 1px solid #ddd;
        padding: 15px;
        margin: 15px 0;
        background: white;
        border-radius: 10px;
      }
      .message {
        margin: 15px 0;
        padding: 15px;
        border-radius: 15px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.6;
      }
      .user-message {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        margin-left: auto;
        text-align: right;
      }
      .ai-message {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #2c3e50;
        margin-right: auto;
        border: 1px solid #dee2e6;
      }
      .formatting-analysis {
        background: #e3f2fd;
        color: #1565c0;
        margin: 10px 0;
        padding: 12px;
        border-radius: 8px;
        font-size: 0.9em;
        border-left: 4px solid #2196f3;
      }
      #chatInput {
        width: 70%;
        padding: 12px;
        border: 2px solid #28a745;
        border-radius: 25px;
        font-size: 14px;
        outline: none;
      }
      .test-results {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 10px;
        font-family: "Courier New", monospace;
        margin: 20px 0;
        white-space: pre-wrap;
        max-height: 400px;
        overflow-y: auto;
      }
      .example-box {
        padding: 15px;
        margin: 10px 0;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üìù NULL VOID AI - Clean Formatting Test</h1>
        <p>
          Testing AI responses for clean, natural formatting without asterisks
          or special characters
        </p>
      </div>

      <div class="content">
        <div class="test-section warning">
          <h3>‚ö†Ô∏è Formatting Quality Check</h3>
          <p>
            <strong>Goal:</strong> AI should provide clean, naturally formatted
            responses without asterisks (*), markdown, or awkward formatting.
          </p>
        </div>

        <div class="test-section bad-example">
          <h3>‚ùå Bad Formatting Example</h3>
          <div class="example-box">
            How NULL VOID Helps You Stay Safe in the Future: While these steps
            address the immediate situation, NULL VOID is designed to help you
            prevent future incidents: * Use the Disposable Browser for Anything
            Suspicious: If you encounter a link, website, or email that looks
            even slightly off, always open it in the Disposable Browser. This
            creates a secure, temporary space that keeps anything dangerous from
            touching your main computer. It's like a protective shield! How to
            use:* Just click the NULL VOID extension icon and select "Open in
            Disposable Browser." * Protect Your Email with Temporary Email: For
            any new sign-ups...
          </div>
        </div>

        <div class="test-section good-example">
          <h3>‚úÖ Good Formatting Example</h3>
          <div class="example-box">
            How NULL VOID Helps You Stay Safe in the Future: While these steps
            address the immediate situation, NULL VOID is designed to help you
            prevent future incidents: Use the Disposable Browser for Anything
            Suspicious: If you encounter a link, website, or email that looks
            even slightly off, always open it in the Disposable Browser. This
            creates a secure, temporary space that keeps anything dangerous from
            touching your main computer. It's like a protective shield! How to
            use: Just click the NULL VOID extension icon and select "Open in
            Disposable Browser." Protect Your Email with Temporary Email: For
            any new sign-ups, newsletters, or services you're not sure about,
            use a Temporary Email address. This keeps your real inbox safe from
            spam, phishing attempts, and potential data breaches.
          </div>
        </div>

        <div class="test-section">
          <h3>üß™ Automated Formatting Tests</h3>
          <button onclick="testCleanFormatting()">
            Test: Clean Response Formatting
          </button>
          <button onclick="testNaturalLanguage()">
            Test: Natural Language Flow
          </button>
          <button onclick="testNoSpecialChars()">
            Test: No Special Characters
          </button>
          <button onclick="testReadability()">Test: Overall Readability</button>
          <div id="testResults" class="test-results"></div>
        </div>

        <div class="chat-container">
          <h3>üí¨ Interactive Clean Formatting Test</h3>
          <p>
            Ask questions and check if responses are cleanly formatted without
            asterisks or awkward formatting:
          </p>
          <div id="chatMessages"></div>
          <input
            type="text"
            id="chatInput"
            placeholder="Ask about NULL VOID features..."
            onkeypress="handleKeypress(event)"
          />
          <button onclick="sendMessage()">Send</button>
          <button onclick="clearChat()">Clear</button>
        </div>
      </div>
    </div>

    <script>
      const AI_CONFIG = {
        apiKey: "AIzaSyB-j8iXAEg_W-I2l3PodnJMoO_wgai2VDU",
        baseUrl: "https://generativelanguage.googleapis.com/v1beta",
        model: "gemini-2.5-flash",
      };

      function logTest(testName, result, analysis) {
        const timestamp = new Date().toLocaleTimeString();
        const status = analysis.isCleanlyFormatted ? "‚úÖ PASS" : "‚ùå FAIL";
        const log = `[${timestamp}] ${testName}: ${status}
Formatting Score: ${analysis.formattingScore}%
Issues Found: ${
          analysis.issues.length > 0 ? analysis.issues.join(", ") : "None"
        }
Response Preview: "${result.substring(0, 120)}..."
${"=".repeat(60)}
`;
        document.getElementById("testResults").textContent += log;
      }

      async function sendCleanFormattedAI(message) {
        const prompt = `You are NULL VOID AI, a helpful assistant for users of the NULL VOID browser extension.

üõ°Ô∏è YOUR ROLE:
- Help users understand and use NULL VOID extension features
- Provide simple, easy-to-follow guidance
- Keep explanations user-friendly and accessible
- Focus on what users can see and do in the extension

üéØ RESPONSE FORMATTING RULES:
- Write in clean, natural sentences without asterisks or special formatting
- Use simple bullet points with hyphens (-) when listing steps
- Write clear paragraph breaks for easy reading
- Use everyday language that flows naturally
- Avoid markdown formatting, asterisks, or special characters in responses
- Make responses feel like friendly conversation, not technical documentation

üéØ RESPONSE GUIDELINES:
- Use simple, clear language that anyone can understand
- Give step-by-step instructions using the extension's buttons and menus
- Focus on user interface elements, not technical details
- Never mention file names, code, or internal configurations
- Be encouraging and helpful
- Keep cybersecurity advice practical and easy to follow
- Format responses as natural, readable text without special characters

‚ö†Ô∏è IMPORTANT:
- NO technical jargon or developer terms
- NO file names or internal system details
- NO asterisks (*) or markdown formatting in responses
- Focus on visible buttons, menus, and options in the extension
- Explain what features do for users, not how they work internally
- Write like you're having a friendly conversation

User Question: ${message}

Provide helpful, user-friendly guidance with clean formatting:`;

        try {
          const response = await fetch(
            `${AI_CONFIG.baseUrl}/models/${AI_CONFIG.model}:generateContent?key=${AI_CONFIG.apiKey}`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                  temperature: 0.3,
                  maxOutputTokens: 1200,
                },
              }),
            }
          );

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
          }

          const data = await response.json();
          return data.candidates[0].content.parts[0].text;
        } catch (error) {
          throw new Error(`AI Error: ${error.message}`);
        }
      }

      function analyzeFormatting(response) {
        const issues = [];
        let formattingScore = 100;

        // Check for problematic formatting
        const asteriskCount = (response.match(/\*/g) || []).length;
        if (asteriskCount > 0) {
          issues.push(`${asteriskCount} asterisks found`);
          formattingScore -= asteriskCount * 10;
        }

        // Check for markdown-style formatting
        const markdownPatterns = [
          /\*\*[^*]+\*\*/g, // **bold**
          /\*[^*]+\*/g, // *italic*
          /#+ /g, // headers
          /```/g, // code blocks
          /`[^`]+`/g, // inline code
        ];

        markdownPatterns.forEach((pattern) => {
          const matches = response.match(pattern);
          if (matches) {
            issues.push(`${matches.length} markdown patterns found`);
            formattingScore -= matches.length * 5;
          }
        });

        // Check for awkward formatting patterns
        const awkwardPatterns = [
          /How to use:\*/g, // "How to use:*"
          /\*[A-Z]/g, // "*Something" at start of sentence
          /\.\*/g, // ".*" at end of sentence
        ];

        awkwardPatterns.forEach((pattern) => {
          const matches = response.match(pattern);
          if (matches) {
            issues.push(`${matches.length} awkward patterns found`);
            formattingScore -= matches.length * 15;
          }
        });

        // Reward natural language features
        const naturalFeatures = [
          /\. [A-Z]/g, // Natural sentence breaks
          /\n\n/g, // Paragraph breaks
          /^[A-Z][a-z]/gm, // Natural sentence starts
        ];

        naturalFeatures.forEach((pattern) => {
          const matches = response.match(pattern);
          if (matches) {
            formattingScore += matches.length * 2;
          }
        });

        formattingScore = Math.max(0, Math.min(100, formattingScore));
        const isCleanlyFormatted = formattingScore >= 80 && asteriskCount === 0;

        return {
          formattingScore: Math.round(formattingScore),
          isCleanlyFormatted,
          issues,
          asteriskCount,
          details: `Asterisks: ${asteriskCount}, Issues: ${issues.length}`,
        };
      }

      async function testCleanFormatting() {
        try {
          const result = await sendCleanFormattedAI(
            "How does NULL VOID protect me from dangerous websites?"
          );
          const analysis = analyzeFormatting(result);
          logTest("Clean Formatting", result, analysis);
        } catch (error) {
          logTest("Clean Formatting", "ERROR: " + error.message, {
            isCleanlyFormatted: false,
            formattingScore: 0,
            issues: ["Test failed"],
            asteriskCount: 0,
          });
        }
      }

      async function testNaturalLanguage() {
        try {
          const result = await sendCleanFormattedAI(
            "What should I do if I see a yellow 'Fallback Mode' warning?"
          );
          const analysis = analyzeFormatting(result);
          logTest("Natural Language", result, analysis);
        } catch (error) {
          logTest("Natural Language", "ERROR: " + error.message, {
            isCleanlyFormatted: false,
            formattingScore: 0,
            issues: ["Test failed"],
            asteriskCount: 0,
          });
        }
      }

      async function testNoSpecialChars() {
        try {
          const result = await sendCleanFormattedAI(
            "Can you explain all the features of NULL VOID and how to use them?"
          );
          const analysis = analyzeFormatting(result);
          logTest("No Special Characters", result, analysis);
        } catch (error) {
          logTest("No Special Characters", "ERROR: " + error.message, {
            isCleanlyFormatted: false,
            formattingScore: 0,
            issues: ["Test failed"],
            asteriskCount: 0,
          });
        }
      }

      async function testReadability() {
        try {
          const result = await sendCleanFormattedAI(
            "How do I use the temporary email feature for safe online registrations?"
          );
          const analysis = analyzeFormatting(result);
          logTest("Overall Readability", result, analysis);
        } catch (error) {
          logTest("Overall Readability", "ERROR: " + error.message, {
            isCleanlyFormatted: false,
            formattingScore: 0,
            issues: ["Test failed"],
            asteriskCount: 0,
          });
        }
      }

      function addChatMessage(message, isUser = false) {
        const chatMessages = document.getElementById("chatMessages");
        const messageDiv = document.createElement("div");
        messageDiv.className = `message ${
          isUser ? "user-message" : "ai-message"
        }`;
        messageDiv.innerHTML = message.replace(/\n/g, "<br>");
        chatMessages.appendChild(messageDiv);

        if (!isUser) {
          // Add formatting analysis for AI responses
          const analysis = analyzeFormatting(message);
          const analysisDiv = document.createElement("div");
          analysisDiv.className = "formatting-analysis";

          const statusIcon = analysis.isCleanlyFormatted ? "‚úÖ" : "‚ùå";
          const statusText = analysis.isCleanlyFormatted
            ? "Clean"
            : "Needs Improvement";

          analysisDiv.innerHTML = `üìù Formatting: ${
            analysis.formattingScore
          }% | ${statusIcon} ${statusText} | Asterisks: ${
            analysis.asteriskCount
          } | Issues: ${
            analysis.issues.length > 0 ? analysis.issues.join(", ") : "None"
          }`;
          chatMessages.appendChild(analysisDiv);
        }

        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      async function sendMessage() {
        const input = document.getElementById("chatInput");
        const message = input.value.trim();

        if (!message) return;

        addChatMessage(message, true);
        input.value = "";

        try {
          const response = await sendCleanFormattedAI(message);
          addChatMessage(response, false);
        } catch (error) {
          addChatMessage(`Error: ${error.message}`, false);
        }
      }

      function handleKeypress(event) {
        if (event.key === "Enter") {
          sendMessage();
        }
      }

      function clearChat() {
        document.getElementById("chatMessages").innerHTML = "";
      }

      // Initialize
      window.addEventListener("load", () => {
        addChatMessage(
          "üìù NULL VOID AI Clean Formatting Test ready! Ask questions and I'll respond with clean, natural formatting.",
          false
        );
      });
    </script>
  </body>
</html>
